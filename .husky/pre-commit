#!/usr/bin/env sh

# Run TypeScript type checking and Design System linting before commit
echo "ğŸ” Running pre-commit checks..."

# Get the root directory of the monorepo
ROOT_DIR="$(cd "$(dirname "$0")/.." && pwd)"
cd "$ROOT_DIR"

# Type check critical packages
echo "ğŸ” Type checking packages..."
pnpm type-check:ui || {
  echo "âŒ Type checking failed in @fragment_ui/ui"
  echo "Please fix the TypeScript errors above before committing."
  exit 1
}

pnpm type-check:blocks || {
  echo "âŒ Type checking failed in @fragment_ui/blocks"
  echo "Please fix the TypeScript errors above before committing."
  exit 1
}

pnpm type-check:www || {
  echo "âŒ Type checking failed in fragment-www"
  echo "Please fix the TypeScript errors above before committing."
  exit 1
}

echo "âœ… Type checking passed!"

# Lint apps/demo (only package with lint:ds script)
echo "ğŸ” Running Design System lint checks..."
echo "Linting apps/demo..."
pnpm --filter fragment-demo lint:ds || {
  echo "âŒ Design System linting failed in apps/demo"
  echo "Please fix the errors above before committing."
  exit 1
}

echo "âœ… All pre-commit checks passed!"

