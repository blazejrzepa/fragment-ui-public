{
  "name": "rating",
  "type": "registry:component",
  "dependencies": [
    "react",
    "react-dom",
    "@fragment_ui/ui"
  ],
  "files": [
    {
      "path": "components/ui/Rating.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport clsx from \"clsx\";\nimport { Star } from \"lucide-react\";\n\nexport interface RatingProps {\n  value?: number;\n  defaultValue?: number;\n  onChange?: (value: number) => void;\n  max?: number; // default: 5\n  half?: boolean; // half-star support\n  readOnly?: boolean;\n  size?: \"sm\" | \"md\" | \"lg\";\n  disabled?: boolean;\n  className?: string;\n  showValue?: boolean; // show numeric value\n  allowClear?: boolean; // allow clearing rating by clicking current value\n}\n\nconst sizeClasses = {\n  sm: \"h-4 w-4\",\n  md: \"h-5 w-5\",\n  lg: \"h-6 w-6\",\n};\n\nconst sizeTextClasses = {\n  sm: \"text-xs\",\n  md: \"text-sm\",\n  lg: \"text-base\",\n};\n\nexport const Rating = React.memo(\n  React.forwardRef<HTMLDivElement, RatingProps>(\n    function Rating(\n    {\n      value: controlledValue,\n      defaultValue,\n      onChange,\n      max = 5,\n      half = false,\n      readOnly = false,\n      size = \"md\",\n      disabled = false,\n      className,\n      showValue = false,\n      allowClear = false,\n      ...props\n    },\n    ref\n  ) {\n    const [uncontrolledValue, setUncontrolledValue] = React.useState(\n      defaultValue ?? 0\n    );\n    const [hoverValue, setHoverValue] = React.useState<number | null>(null);\n\n    const isControlled = controlledValue !== undefined;\n    const currentValue = isControlled ? controlledValue : uncontrolledValue;\n    const displayValue = hoverValue ?? currentValue;\n\n    const handleClick = React.useCallback(\n      (newValue: number) => {\n        if (disabled || readOnly) return;\n\n        // If allowClear and clicking the same value, clear it\n        if (allowClear && newValue === currentValue) {\n          const clearedValue = 0;\n          if (!isControlled) {\n            setUncontrolledValue(clearedValue);\n          }\n          onChange?.(clearedValue);\n          return;\n        }\n\n        if (!isControlled) {\n          setUncontrolledValue(newValue);\n        }\n        onChange?.(newValue);\n      },\n      [disabled, readOnly, allowClear, currentValue, isControlled, onChange]\n    );\n\n    const handleMouseEnter = React.useCallback(\n      (starValue: number) => {\n        if (disabled || readOnly) return;\n        setHoverValue(starValue);\n      },\n      [disabled, readOnly]\n    );\n\n    const handleMouseLeave = React.useCallback(() => {\n      if (disabled || readOnly) return;\n      setHoverValue(null);\n    }, [disabled, readOnly]);\n\n    const getStarFill = React.useCallback(\n      (starIndex: number) => {\n        const starValue = starIndex + 1;\n        const halfStarValue = starValue - 0.5;\n\n        if (displayValue >= starValue) {\n          return 1; // Full star\n        } else if (half && displayValue >= halfStarValue) {\n          return 0.5; // Half star\n        }\n        return 0; // Empty star\n      },\n      [displayValue, half]\n    );\n\n    const handleHalfStarClick = React.useCallback(\n      (starIndex: number) => {\n        if (disabled || readOnly || !half) return;\n        const halfStarValue = starIndex + 0.5;\n        handleClick(halfStarValue);\n      },\n      [disabled, readOnly, half, handleClick]\n    );\n\n    const handleFullStarClick = React.useCallback(\n      (starIndex: number) => {\n        if (disabled || readOnly) return;\n        const fullStarValue = starIndex + 1;\n        handleClick(fullStarValue);\n      },\n      [disabled, readOnly, handleClick]\n    );\n\n    return (\n      <div\n        ref={ref}\n        className={clsx(\n          \"inline-flex items-center gap-[var(--space-2)]\",\n          disabled && \"opacity-60 cursor-not-allowed\",\n          readOnly && \"cursor-default\",\n          !disabled && !readOnly && \"cursor-pointer\",\n          className\n        )}\n        onMouseLeave={handleMouseLeave}\n        role={readOnly ? \"img\" : \"radiogroup\"}\n        aria-label={`Rating: ${currentValue} out of ${max} stars`}\n        aria-valuenow={currentValue}\n        aria-valuemin={0}\n        aria-valuemax={max}\n        {...props}\n      >\n        <div className=\"flex items-center gap-0.5\">\n          {Array.from({ length: max }, (_, index) => {\n            const fill = getStarFill(index);\n            const isFilled = fill > 0;\n            const isHalfFilled = fill === 0.5;\n\n            if (readOnly) {\n              // In readOnly mode, render stars without buttons\n              return (\n                <div key={index} className=\"relative inline-flex\">\n                  {half ? (\n                    <>\n                      {/* Half star (left) */}\n                      <div\n                        className={clsx(\n                          \"absolute left-0 top-0 overflow-hidden\",\n                          sizeClasses[size]\n                        )}\n                        style={{ width: \"50%\" }}\n                        aria-hidden=\"true\"\n                      >\n                        <Star\n                          className={clsx(\n                            sizeClasses[size],\n                            isHalfFilled || isFilled\n                              ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                              : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                          )}\n                        />\n                      </div>\n                      {/* Half star (right) */}\n                      <div\n                        className={clsx(\n                          \"absolute right-0 top-0 overflow-hidden\",\n                          sizeClasses[size]\n                        )}\n                        style={{ width: \"50%\" }}\n                        aria-hidden=\"true\"\n                      >\n                        <Star\n                          className={clsx(\n                            sizeClasses[size],\n                            isFilled\n                              ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                              : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                          )}\n                        />\n                      </div>\n                      {/* Background star */}\n                      <Star\n                        className={clsx(\n                          sizeClasses[size],\n                          \"fill-transparent text-[color:var(--color-fg-muted)] pointer-events-none\"\n                        )}\n                      />\n                    </>\n                  ) : (\n                    <Star\n                      className={clsx(\n                        sizeClasses[size],\n                        isFilled\n                          ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                          : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                      )}\n                    />\n                  )}\n                </div>\n              );\n            }\n\n            return (\n              <div\n                key={index}\n                className=\"relative inline-flex\"\n                onMouseEnter={() => handleMouseEnter(index + 1)}\n              >\n                {half ? (\n                  <>\n                    {/* Half star (left) */}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleHalfStarClick(index)}\n                      disabled={disabled}\n                      className={clsx(\n                        \"absolute left-0 top-0 overflow-hidden\",\n                        sizeClasses[size],\n                        \"transition-colors\",\n                        !disabled && \"hover:opacity-80\"\n                      )}\n                      style={{ width: \"50%\" }}\n                      aria-label={`Rate ${index + 0.5} stars`}\n                    >\n                      <Star\n                        className={clsx(\n                          sizeClasses[size],\n                          isHalfFilled || isFilled\n                            ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                            : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                        )}\n                      />\n                    </button>\n                    {/* Half star (right) */}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleFullStarClick(index)}\n                      disabled={disabled}\n                      className={clsx(\n                        \"absolute right-0 top-0 overflow-hidden\",\n                        sizeClasses[size],\n                        \"transition-colors\",\n                        !disabled && \"hover:opacity-80\"\n                      )}\n                      style={{ width: \"50%\" }}\n                      aria-label={`Rate ${index + 1} stars`}\n                    >\n                      <Star\n                        className={clsx(\n                          sizeClasses[size],\n                          isFilled\n                            ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                            : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                        )}\n                      />\n                    </button>\n                    {/* Background star */}\n                    <Star\n                      className={clsx(\n                        sizeClasses[size],\n                        \"fill-transparent text-[color:var(--color-fg-muted)] pointer-events-none\"\n                      )}\n                    />\n                  </>\n                ) : (\n                  <button\n                    type=\"button\"\n                    onClick={() => handleFullStarClick(index)}\n                    disabled={disabled}\n                    className={clsx(\n                      \"transition-colors\",\n                      !disabled && \"hover:opacity-80\"\n                    )}\n                    aria-label={`Rate ${index + 1} stars`}\n                  >\n                    <Star\n                      className={clsx(\n                        sizeClasses[size],\n                        isFilled\n                          ? \"fill-[color:var(--color-brand-primary)] text-[color:var(--color-brand-primary)]\"\n                          : \"fill-transparent text-[color:var(--color-fg-muted)]\"\n                      )}\n                    />\n                  </button>\n                )}\n              </div>\n            );\n          })}\n        </div>\n        {showValue && (\n          <span\n            className={clsx(\n              \"font-medium text-[color:var(--color-fg-base)]\",\n              sizeTextClasses[size]\n            )}\n          >\n            {currentValue.toFixed(half ? 1 : 0)}/{max}\n          </span>\n        )}\n      </div>\n    );\n  }\n  )\n);\n\nRating.displayName = \"Rating\";\n\n"
    }
  ]
}