{
  "name": "combobox",
  "type": "registry:component",
  "dependencies": [
    "react",
    "react-dom",
    "@fragment_ui/ui"
  ],
  "files": [
    {
      "path": "components/ui/Combobox.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport clsx from \"clsx\";\nimport { ChevronDown, Check, Search } from \"lucide-react\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"./popover\";\nimport { Button } from \"./button\";\nimport {\n  Command,\n  CommandEmpty,\n  CommandGroup,\n  CommandInput,\n  CommandItem,\n  CommandList,\n} from \"./command\";\n\nexport interface ComboboxOption {\n  value: string;\n  label: string;\n  disabled?: boolean;\n}\n\nexport interface ComboboxProps {\n  options: ComboboxOption[];\n  value?: string;\n  onValueChange?: (value: string) => void;\n  placeholder?: string;\n  searchPlaceholder?: string;\n  emptyText?: string;\n  className?: string;\n  disabled?: boolean;\n  size?: \"sm\" | \"md\" | \"lg\";\n}\n\nexport const Combobox = React.forwardRef<HTMLButtonElement, ComboboxProps>(\n  function Combobox(\n    {\n      options,\n      value,\n      onValueChange,\n      placeholder = \"Select option...\",\n      searchPlaceholder = \"Search...\",\n      emptyText = \"No results found.\",\n      className,\n      disabled,\n      size = \"sm\",\n    },\n    ref\n  ) {\n    const [open, setOpen] = React.useState(false);\n    const [search, setSearch] = React.useState(\"\");\n\n    const selectedOption = options.find((opt) => opt.value === value);\n\n    const filteredOptions = React.useMemo(() => {\n      if (!search) return options;\n      return options.filter((option) =>\n        option.label.toLowerCase().includes(search.toLowerCase())\n      );\n    }, [options, search]);\n\n    // Check if className contains a width class\n    const hasWidthClass = className && /w-\\[?[\\d]+|w-(full|auto|screen|min|max|fit)/.test(className);\n    const widthClass = hasWidthClass ? \"\" : \"w-full\";\n    \n    // Extract width from className to match PopoverContent width\n    const widthMatch = className?.match(/w-\\[(\\d+)px\\]|w-(\\d+)/);\n    const popoverWidth = widthMatch ? (widthMatch[1] ? `w-[${widthMatch[1]}px]` : `w-${widthMatch[2]}`) : \"w-full\";\n\n    return (\n      <Popover open={open} onOpenChange={setOpen} modal={false}>\n        <PopoverTrigger asChild>\n          <Button\n            ref={ref}\n            variant=\"secondary\"\n            size={size}\n            trailingIcon={<ChevronDown className=\"h-3.5 w-3.5 shrink-0 opacity-50\" />}\n            role=\"combobox\"\n            aria-expanded={open}\n            className={clsx(\"justify-between\", widthClass, open && \"focus-visible:ring-0\", className)}\n            disabled={disabled}\n          >\n            <span className=\"flex-1 text-left truncate text-xs\">\n              {selectedOption ? selectedOption.label : placeholder}\n            </span>\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent \n          className={clsx(popoverWidth, \"p-0 py-[var(--space-2)]\")} \n          align=\"start\" \n          side=\"bottom\" \n          sideOffset={4}\n          style={!widthMatch ? { width: \"var(--radix-popover-trigger-width)\", minWidth: \"var(--radix-popover-trigger-width)\" } : undefined}\n        >\n          <Command shouldFilter={false}>\n            <div className=\"flex h-9 items-center gap-[var(--space-2)] border-b border-[color:var(--color-border-base)] px-[var(--space-3)]\">\n              <Search className=\"h-4 w-4 shrink-0 opacity-50\" />\n              <input\n                placeholder={searchPlaceholder}\n                className=\"flex w-full rounded-[var(--radius-sm)] bg-transparent py-[var(--space-3)] text-sm outline-hidden placeholder:text-[color:var(--color-fg-muted)] disabled:cursor-not-allowed disabled:opacity-50 h-9 focus-visible:ring-0 focus-visible:outline-none\"\n                value={search}\n                onChange={(e) => setSearch(e.target.value)}\n              />\n            </div>\n            <CommandList>\n              <CommandEmpty>{emptyText}</CommandEmpty>\n              <CommandGroup className=\"p-[var(--space-2)]\">\n                {filteredOptions.map((option) => (\n                  <CommandItem\n                    key={option.value}\n                    value={option.value}\n                    disabled={option.disabled}\n                    onSelect={(currentValue) => {\n                      onValueChange?.(currentValue === value ? \"\" : currentValue);\n                      setOpen(false);\n                      setSearch(\"\");\n                    }}\n                    className=\"py-[var(--space-2)]\"\n                  >\n                    {option.label}\n                    <Check\n                      className={clsx(\n                        \"ml-auto h-4 w-4\",\n                        value === option.value ? \"opacity-100\" : \"opacity-0\"\n                      )}\n                    />\n                  </CommandItem>\n                ))}\n              </CommandGroup>\n            </CommandList>\n          </Command>\n        </PopoverContent>\n      </Popover>\n    );\n  }\n);\n\n\n"
    }
  ]
}