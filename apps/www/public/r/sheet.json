{
  "name": "sheet",
  "type": "registry:component",
  "dependencies": [
    "react",
    "react-dom",
    "@fragment_ui/ui"
  ],
  "files": [
    {
      "path": "components/ui/Sheet.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\";\nimport clsx from \"clsx\";\n\nconst Sheet = DialogPrimitive.Root;\nconst SheetTrigger = DialogPrimitive.Trigger;\nconst SheetClose = DialogPrimitive.Close;\nconst SheetPortal = DialogPrimitive.Portal;\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    className={clsx(\n      \"fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n));\nSheetOverlay.displayName = DialogPrimitive.Overlay.displayName;\n\ntype SheetContentProps = React.ComponentPropsWithoutRef<\n  typeof DialogPrimitive.Content\n> & {\n  side?: \"top\" | \"right\" | \"bottom\" | \"left\";\n  /**\n   * Enable scroll detection (detects when main page is at bottom)\n   * @default false\n   */\n  scrollDetection?: boolean;\n  /**\n   * Enable wheel handling (redirects wheel events to Sheet content when main page is at bottom)\n   * @default false\n   */\n  wheelHandling?: boolean;\n  /**\n   * CSS selector for the scrollable content element inside Sheet\n   * If not provided, will look for the first scrollable element\n   * @default undefined\n   */\n  scrollableSelector?: string;\n};\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  SheetContentProps\n>(\n  (\n    { \n      side = \"right\", \n      className, \n      children, \n      scrollDetection = false,\n      wheelHandling = false,\n      scrollableSelector,\n      ...props \n    },\n    ref\n  ) => {\n    const contentRef = React.useRef<HTMLDivElement>(null);\n    const scrollableRef = React.useRef<HTMLElement | null>(null);\n    const [isMainAtBottom, setIsMainAtBottom] = React.useState(false);\n\n    // Combine refs\n    React.useImperativeHandle(ref, () => contentRef.current as any);\n\n    // Find scrollable element\n    React.useEffect(() => {\n      if (!contentRef.current) return;\n\n      if (scrollableSelector) {\n        scrollableRef.current = contentRef.current.querySelector(scrollableSelector);\n      } else {\n        // Find first scrollable element\n        const findScrollable = (element: HTMLElement): HTMLElement | null => {\n          const style = window.getComputedStyle(element);\n          if (style.overflowY === \"auto\" || style.overflowY === \"scroll\") {\n            return element;\n          }\n          for (const child of Array.from(element.children)) {\n            if (child instanceof HTMLElement) {\n              const found = findScrollable(child);\n              if (found) return found;\n            }\n          }\n          return null;\n        };\n        scrollableRef.current = findScrollable(contentRef.current);\n      }\n    }, [scrollableSelector, children]);\n\n    // Check if main container is scrolled to bottom\n    React.useEffect(() => {\n      if (!scrollDetection) return;\n\n      const handleScroll = () => {\n        const threshold = 10; // 10px threshold\n        const scrollTop = window.scrollY || document.documentElement.scrollTop;\n        const windowHeight = window.innerHeight;\n        const documentHeight = document.documentElement.scrollHeight;\n\n        const isAtBottom = scrollTop + windowHeight >= documentHeight - threshold;\n        setIsMainAtBottom(isAtBottom);\n      };\n\n      handleScroll();\n      window.addEventListener(\"scroll\", handleScroll, { passive: true });\n      window.addEventListener(\"resize\", handleScroll, { passive: true });\n\n      return () => {\n        window.removeEventListener(\"scroll\", handleScroll);\n        window.removeEventListener(\"resize\", handleScroll);\n      };\n    }, [scrollDetection]);\n\n    // Redirect wheel events to Sheet content when at bottom\n    React.useEffect(() => {\n      if (!wheelHandling || !isMainAtBottom || !scrollableRef.current) return;\n\n      const handleWheel = (e: WheelEvent) => {\n        const scrollable = scrollableRef.current;\n        if (!scrollable) return;\n\n        // Check if scrollable can scroll\n        const canScrollUp = scrollable.scrollTop > 0;\n        const canScrollDown = scrollable.scrollTop < scrollable.scrollHeight - scrollable.clientHeight;\n\n        // Only intercept if we're at bottom and scrollable can scroll\n        if (isMainAtBottom && (canScrollUp || canScrollDown)) {\n          const scrollingDown = e.deltaY > 0;\n          const scrollingUp = e.deltaY < 0;\n\n          const scrollableAtBottom = scrollable.scrollTop >= scrollable.scrollHeight - scrollable.clientHeight - 1;\n          const scrollableAtTop = scrollable.scrollTop <= 1;\n\n          // If scrolling down and scrollable is not at bottom, or scrolling up and scrollable is not at top\n          if ((scrollingDown && !scrollableAtBottom) || (scrollingUp && !scrollableAtTop)) {\n            e.preventDefault();\n            scrollable.scrollTop += e.deltaY;\n          }\n        }\n      };\n\n      window.addEventListener(\"wheel\", handleWheel, { passive: false });\n\n      return () => {\n        window.removeEventListener(\"wheel\", handleWheel);\n      };\n    }, [isMainAtBottom, wheelHandling]);\n\n    return (\n      <SheetPortal>\n        <SheetOverlay />\n        <DialogPrimitive.Content\n          ref={contentRef}\n          className={clsx(\n            \"fixed z-50 gap-[var(--space-4)] bg-[color:var(--color-surface-1)] p-[var(--space-6)] shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n            side === \"top\" &&\n              \"inset-x-0 top-0 border-b border-[color:var(--color-border-base)] data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n            side === \"bottom\" &&\n              \"inset-x-0 bottom-0 border-t border-[color:var(--color-border-base)] data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n            side === \"left\" &&\n              \"inset-y-0 left-0 h-full w-3/4 border-r border-[color:var(--color-border-base)] data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n            side === \"right\" &&\n              \"inset-y-0 right-0 h-full w-3/4 border-l border-[color:var(--color-border-base)] data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n          <DialogPrimitive.Close className=\"absolute right-[var(--space-4)] top-[var(--space-4)] rounded-[var(--radius-sm)] opacity-70 ring-offset-[color:var(--color-surface-1)] transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-brand-primary)] focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-[color:var(--color-surface-2)]\">\n            âœ•\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        </DialogPrimitive.Content>\n      </SheetPortal>\n    );\n  }\n);\nSheetContent.displayName = DialogPrimitive.Content.displayName;\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={clsx(\n      \"flex flex-col space-y-[var(--space-2)] text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n);\nSheetHeader.displayName = \"SheetHeader\";\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={clsx(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n);\nSheetFooter.displayName = \"SheetFooter\";\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={clsx(\"text-lg font-semibold text-[color:var(--color-fg-base)]\", className)}\n    {...props}\n  />\n));\nSheetTitle.displayName = DialogPrimitive.Title.displayName;\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={clsx(\"text-sm text-[color:var(--color-fg-muted)]\", className)}\n    {...props}\n  />\n));\nSheetDescription.displayName = DialogPrimitive.Description.displayName;\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n};\n\n\n"
    }
  ]
}