@import "@fragment_ui/tokens/dist/tokens.css";
@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
  color-scheme: light dark;
}

/* Global font rendering optimization - Chrome specific */
* {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Chrome: use auto instead of optimizeLegibility to prevent blur */
  text-rendering: auto;
  /* Chrome: prevent subpixel rendering blur */
  -webkit-text-stroke: 0.35px transparent;
  /* Chrome: force hardware acceleration */
  transform: translate3d(0, 0, 0);
  -webkit-transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

@layer base {
  /* Apply motion tokens to components */
  button, a {
    transition-duration: var(--motion-duration-base, 200ms);
    transition-timing-function: var(--motion-easing-ease-in-out, cubic-bezier(0.4, 0, 0.2, 1));
  }

  /* Accordion animations */
  @keyframes accordion-down {
    from {
      height: 0;
    }
    to {
      height: var(--radix-accordion-content-height);
    }
  }

  @keyframes accordion-up {
    from {
      height: var(--radix-accordion-content-height);
    }
    to {
      height: 0;
    }
  }
}

@layer utilities {
  .animate-accordion-down {
    animation: accordion-down 0.2s ease-out;
  }

  .animate-accordion-up {
    animation: accordion-up 0.2s ease-out;
  }


  /* Collapsible animations */
  @keyframes collapsible-down {
    from {
      height: 0;
    }
    to {
      height: var(--radix-collapsible-content-height);
    }
  }

  @keyframes collapsible-up {
    from {
      height: var(--radix-collapsible-content-height);
    }
    to {
      height: 0;
    }
  }

  .animate-collapsible-down {
    animation: collapsible-down 0.2s ease-out;
  }

  .animate-collapsible-up {
    animation: collapsible-up 0.2s ease-out;
  }
}

/* NavigationMenu styles - ensure text color stays foreground-primary on hover/focus */
/* Using inline styles in component + CSS for maximum specificity */
@layer components {
  /* Button secondary variant - darker hover */
  :root:not([data-theme="dark"]) button[data-button-variant="secondary"]:hover,
  [data-theme="light"] button[data-button-variant="secondary"]:hover {
    background-color: var(--color-surface-2) !important; /* Darker hover color in light mode */
  }

  [data-theme="dark"] button[data-button-variant="secondary"]:hover {
    background-color: color-mix(in oklab, var(--color-surface-2) 80%, var(--color-surface-1)) !important; /* Darker hover color in dark mode */
  }

  /* SegmentedControl - darker border in dark mode */
  [data-theme="dark"] [role="group"].ring-1[class*="ring-[color:var(--color-border-base)]"] {
    --tw-ring-color: var(--color-border-muted) !important;
    box-shadow: inset 0 0 0 1px var(--color-border-muted) !important;
  }

  /* Button solid variant - ensure text color uses token */
  /* Using data attribute selector with high specificity to override Tailwind utilities */
  button[data-button-variant="solid"],
  button[data-button-variant="solid"] *,
  button[data-button-variant="solid"] span,
  button[data-button-variant="solid"] svg,
  button[data-button-variant="solid"] svg path {
    color: var(--color-button-solid-text) !important;
  }

  button[data-button-variant="solid"]:hover,
  button[data-button-variant="solid"]:hover *,
  button[data-button-variant="solid"]:hover span,
  button[data-button-variant="solid"]:hover svg,
  button[data-button-variant="solid"]:hover svg path {
    color: var(--color-button-solid-text) !important;
  }

  button[data-button-variant="solid"]:disabled,
  button[data-button-variant="solid"]:disabled *,
  button[data-button-variant="solid"]:disabled span,
  button[data-button-variant="solid"]:disabled svg,
  button[data-button-variant="solid"]:disabled svg path {
    color: var(--color-button-solid-text) !important;
  }
  /* NavigationMenuLink - preserve text color on hover/focus, no underline */
  /* Inline style in component handles text-decoration, but we add CSS as backup */
  [data-radix-navigation-menu-link],
  [data-radix-navigation-menu-link] a,
  [data-radix-navigation-menu-link] * {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* Higher specificity for prose context - override .prose a */
  .prose [data-radix-navigation-menu-link],
  .prose [data-radix-navigation-menu-link] a,
  .prose [data-radix-navigation-menu-link] *,
  nav[aria-label="Main"] [data-radix-navigation-menu-link],
  nav[aria-label="Main"] [data-radix-navigation-menu-link] a,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] * {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  [data-radix-navigation-menu-link]:hover,
  [data-radix-navigation-menu-link]:focus,
  [data-radix-navigation-menu-link]:focus-visible,
  [data-radix-navigation-menu-link]:active,
  [data-radix-navigation-menu-link] a:hover,
  [data-radix-navigation-menu-link] a:focus,
  [data-radix-navigation-menu-link] a:focus-visible,
  [data-radix-navigation-menu-link] a:active,
  [data-radix-navigation-menu-link] *:hover,
  [data-radix-navigation-menu-link] *:focus {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* Higher specificity for prose context - hover/focus states */
  .prose [data-radix-navigation-menu-link]:hover,
  .prose [data-radix-navigation-menu-link]:focus,
  .prose [data-radix-navigation-menu-link] a:hover,
  .prose [data-radix-navigation-menu-link] a:focus,
  .prose [data-radix-navigation-menu-link] *:hover,
  .prose [data-radix-navigation-menu-link] *:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-link]:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-link]:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] a:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] a:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] *:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] *:focus {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* NavigationMenuTrigger - preserve text color on hover/focus, no underline */
  [data-radix-navigation-menu-trigger],
  [data-radix-navigation-menu-trigger] a,
  [data-radix-navigation-menu-trigger] * {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* Higher specificity for prose context */
  .prose [data-radix-navigation-menu-trigger],
  .prose [data-radix-navigation-menu-trigger] a,
  .prose [data-radix-navigation-menu-trigger] *,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger],
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] a,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] * {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  [data-radix-navigation-menu-trigger]:hover,
  [data-radix-navigation-menu-trigger]:focus,
  [data-radix-navigation-menu-trigger]:focus-visible,
  [data-radix-navigation-menu-trigger]:active,
  [data-radix-navigation-menu-trigger] a:hover,
  [data-radix-navigation-menu-trigger] a:focus,
  [data-radix-navigation-menu-trigger] a:focus-visible,
  [data-radix-navigation-menu-trigger] a:active,
  [data-radix-navigation-menu-trigger] *:hover,
  [data-radix-navigation-menu-trigger] *:focus {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* Higher specificity for prose context - hover/focus states */
  .prose [data-radix-navigation-menu-trigger]:hover,
  .prose [data-radix-navigation-menu-trigger]:focus,
  .prose [data-radix-navigation-menu-trigger] a:hover,
  .prose [data-radix-navigation-menu-trigger] a:focus,
  .prose [data-radix-navigation-menu-trigger] *:hover,
  .prose [data-radix-navigation-menu-trigger] *:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger]:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger]:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] a:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] a:focus,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] *:hover,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] *:focus {
    color: var(--color-fg-base) !important;
    text-decoration: none !important;
  }
  
  /* Hide default Radix UI trigger icon */
  [data-radix-navigation-menu-trigger] > span:last-child {
    display: none !important;
  }
  
  /* Ensure child elements also preserve color and no underline */
  [data-radix-navigation-menu-link] *,
  [data-radix-navigation-menu-link]:hover *,
  [data-radix-navigation-menu-link]:focus *,
  [data-radix-navigation-menu-link] a *,
  [data-radix-navigation-menu-link] a:hover *,
  [data-radix-navigation-menu-link] a:focus * {
    color: inherit;
    text-decoration: none;
  }
  
  /* Force viewport wrapper to align to left edge of trigger */
  [data-radix-navigation-menu-root] > div[style*="position"] {
    left: 0 !important;
    transform: translateX(0) !important;
    justify-content: flex-start !important;
  }
  
  /* Force viewport to align to left edge */
  [data-radix-navigation-menu-viewport] {
    left: 0 !important;
    transform: translateX(0) !important;
  }
  
  /* Force content to align to left edge within viewport */
  [data-radix-navigation-menu-content] {
    left: 0 !important;
    transform: translateX(0) !important;
  }
  
  /* Override Radix UI positioning for viewport wrapper */
  [data-radix-navigation-menu-root] > div:has([data-radix-navigation-menu-viewport]) {
    left: 0 !important;
    transform: translateX(0) !important;
    justify-content: flex-start !important;
  }
  
  /* Higher specificity for prose context - child elements */
  .prose [data-radix-navigation-menu-link] *,
  .prose [data-radix-navigation-menu-link] a *,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] *,
  nav[aria-label="Main"] [data-radix-navigation-menu-link] a *,
  .prose [data-radix-navigation-menu-trigger] *,
  .prose [data-radix-navigation-menu-trigger] a *,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] *,
  nav[aria-label="Main"] [data-radix-navigation-menu-trigger] a * {
    color: inherit !important;
    text-decoration: none !important;
  }
  
  /* CodeBlock - exclude from prose styles */
  /* Use higher specificity to override prose styles */
  /* CodeBlock styles - matching shadcn/ui appearance */
  /* Note: margin is set inline in CodeBlock component wrapper div */
  
  .not-prose pre,
  article .not-prose pre,
  .prose .not-prose pre,
  .document-content .not-prose pre {
    /* Reset prose styles and apply CodeBlock styles */
    background-color: var(--color-surface-1) !important;
    padding: var(--space-4) var(--space-6) !important; /* 16px 24px - zgodne z tokenami DS */
    border-radius: var(--radius-sm) !important; /* 8px - zgodne z tokenami DS */
    border: 1px solid var(--color-border-base) !important;
    max-height: 400px !important;
    overflow-y: auto !important;
    margin: 0 !important;
  }
  
  /* Shiki-generated pre inside CodeBlock wrapper */
  .not-prose > div > pre,
  article .not-prose > div > pre,
  .document-content .not-prose > div > pre,
  /* Override Shiki inline styles with higher specificity */
  .not-prose > div > pre[style],
  article .not-prose > div > pre[style],
  .document-content .not-prose > div > pre[style] {
    /* Ensure Shiki pre uses our styles - matching shadcn/ui appearance */
    background-color: var(--color-surface-1) !important;
    padding: var(--space-4) var(--space-6) !important; /* 16px 24px - zgodne z tokenami DS */
    border-radius: var(--radius-sm) !important; /* 8px - zgodne z tokenami DS */
    border: 1px solid var(--color-border-base) !important;
    max-height: 400px !important;
    overflow-y: auto !important;
    margin: 0 !important;
  }
  
  /* Shiki-generated pre with data-theme attribute */
  .not-prose > div > pre[data-theme],
  article .not-prose > div > pre[data-theme],
  .document-content .not-prose > div > pre[data-theme],
  /* Override Shiki inline styles with maximum specificity */
  .document-content .not-prose > div > pre[data-theme][style] {
    /* Override Shiki's inline styles to match our design */
    background-color: var(--color-surface-1) !important;
    border: 1px solid var(--color-border-base) !important;
    border-radius: var(--radius-sm) !important; /* 8px - zgodne z tokenami DS */
    padding: var(--space-4) var(--space-6) !important; /* 16px 24px - zgodne z tokenami DS */
    margin: 0 !important;
  }
  
  /* Light mode Shiki pre */
  [data-theme="light"] .not-prose > div > pre[data-theme],
  :root:not([data-theme="dark"]) .not-prose > div > pre[data-theme],
  [data-theme="light"] .document-content .not-prose > div > pre[data-theme],
  :root:not([data-theme="dark"]) .document-content .not-prose > div > pre[data-theme] {
    background-color: var(--color-surface-1) !important;
    border: 1px solid var(--color-border-base) !important;
    border-radius: var(--radius-sm) !important;
    border-color: var(--color-border-base) !important;
    margin: 0 !important;
  }
  
  /* Dark mode Shiki pre */
  [data-theme="dark"] .not-prose > div > pre[data-theme],
  [data-theme="dark"] .document-content .not-prose > div > pre[data-theme] {
    background-color: var(--color-surface-1) !important;
    border: 1px solid var(--color-border-base) !important;
    border-radius: var(--radius-sm) !important;
    border-color: var(--color-border-base) !important;
    margin: 0 !important;
  }
  
  .not-prose pre code,
  article .not-prose pre code,
  .prose .not-prose pre code {
    /* Code inside pre - reset styles */
    background: transparent !important;
    padding: 0 !important;
    border-radius: 0 !important;
    margin: 0 !important;
    font-family: 'SF Mono', SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace !important;
    font-weight: 300 !important;
  }

  /* Line numbers for CodeBlock */
  /* Shiki generates: <pre class="shiki"><code class="line-numbers"><span class="line">...</span></code></pre> */
  /* Based on shadcn/ui implementation */
  pre code.line-numbers,
  pre code[data-line-numbers],
  pre[class*="shiki"] code.line-numbers,
  pre[class*="shiki"] code[data-line-numbers],
  .not-prose pre code.line-numbers,
  .not-prose pre code[data-line-numbers],
  article .not-prose pre code.line-numbers,
  article .not-prose pre code[data-line-numbers],
  .not-prose pre[class*="shiki"] code.line-numbers,
  .not-prose pre[class*="shiki"] code[data-line-numbers],
  article .not-prose pre[class*="shiki"] code.line-numbers,
  article .not-prose pre[class*="shiki"] code[data-line-numbers] {
    counter-reset: line !important;
    padding-left: 0 !important;
    position: relative !important;
    display: block !important;
    /* Optimize counter rendering */
    contain: layout style !important;
    will-change: contents !important;
  }

  /* Each line gets a number using CSS counter */
  pre code.line-numbers .line,
  pre code[data-line-numbers] .line,
  .not-prose pre code.line-numbers .line,
  .not-prose pre code[data-line-numbers] .line,
  pre[class*="shiki"] code.line-numbers .line,
  pre[class*="shiki"] code[data-line-numbers] .line,
  .not-prose pre[class*="shiki"] code.line-numbers .line,
  .not-prose pre[class*="shiki"] code[data-line-numbers] .line,
  article .not-prose pre[class*="shiki"] code.line-numbers .line,
  article .not-prose pre[class*="shiki"] code[data-line-numbers] .line,
  /* Override inline styles from Shiki */
  pre[class*="shiki"] code.line-numbers .line[style],
  pre[class*="shiki"] code[data-line-numbers] .line[style],
  .not-prose pre[class*="shiki"] code.line-numbers .line[style],
  .not-prose pre[class*="shiki"] code[data-line-numbers] .line[style] {
    counter-increment: line !important;
    position: relative !important;
    display: inline-block !important;
    width: 100% !important;
    margin: 0 !important;
    padding: 0 !important;
    padding-left: 4em !important;
    line-height: 1.5 !important;
    min-height: 1.5em !important;
    /* Optimize counter rendering */
    contain: layout style !important;
  }

  /* Ensure empty lines are visible and numbered */
  pre code.line-numbers .line:empty,
  pre code[data-line-numbers] .line:empty,
  .not-prose pre code.line-numbers .line:empty,
  .not-prose pre code[data-line-numbers] .line:empty {
    display: inline-block !important;
    min-height: 1.5em !important;
  }

  /* Line number styling - use data-line attribute for immediate rendering */
  pre code.line-numbers .line[data-line]::before,
  pre code[data-line-numbers] .line[data-line]::before,
  .not-prose pre code.line-numbers .line[data-line]::before,
  .not-prose pre code[data-line-numbers] .line[data-line]::before {
    content: attr(data-line) !important;
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    width: 2em !important;
    text-align: right !important;
    padding-right: 0.5em !important;
    color: var(--color-fg-muted) !important;
    user-select: none !important;
    font-variant-numeric: tabular-nums !important;
    opacity: 0.6 !important;
    line-height: 1.5 !important;
    display: inline-block !important;
    /* Optimize rendering - force immediate paint */
    will-change: contents !important;
    contain: layout style paint !important;
  }

  /* Fallback to counter for lines without data-line attribute */
  pre code.line-numbers .line:not([data-line])::before,
  pre code[data-line-numbers] .line:not([data-line])::before,
  .not-prose pre code.line-numbers .line:not([data-line])::before,
  .not-prose pre code[data-line-numbers] .line:not([data-line])::before {
    content: counter(line) !important;
    position: absolute !important;
    left: 0 !important;
    top: 0 !important;
    width: 2em !important;
    text-align: right !important;
    padding-right: 0.5em !important;
    color: var(--color-fg-muted) !important;
    user-select: none !important;
    font-variant-numeric: tabular-nums !important;
    opacity: 0.6 !important;
    line-height: 1.5 !important;
    display: inline-block !important;
  }

  /* Dark mode line numbers */
  [data-theme="dark"] pre code.line-numbers .line[data-line]::before,
  [data-theme="dark"] pre code[data-line-numbers] .line[data-line]::before,
  [data-theme="dark"] .not-prose pre code.line-numbers .line[data-line]::before,
  [data-theme="dark"] .not-prose pre code[data-line-numbers] .line[data-line]::before,
  [data-theme="dark"] pre code.line-numbers .line:not([data-line])::before,
  [data-theme="dark"] pre code[data-line-numbers] .line:not([data-line])::before,
  [data-theme="dark"] .not-prose pre code.line-numbers .line:not([data-line])::before,
  [data-theme="dark"] .not-prose pre code[data-line-numbers] .line:not([data-line])::before {
    opacity: 0.5 !important;
  }

  /* Light mode line numbers */
  [data-theme="light"] pre code.line-numbers .line[data-line]::before,
  [data-theme="light"] pre code[data-line-numbers] .line[data-line]::before,
  :root:not([data-theme="dark"]) pre code.line-numbers .line[data-line]::before,
  :root:not([data-theme="dark"]) pre code[data-line-numbers] .line[data-line]::before,
  [data-theme="light"] .not-prose pre code.line-numbers .line[data-line]::before,
  [data-theme="light"] .not-prose pre code[data-line-numbers] .line[data-line]::before,
  :root:not([data-theme="dark"]) .not-prose pre code.line-numbers .line[data-line]::before,
  :root:not([data-theme="dark"]) .not-prose pre code[data-line-numbers] .line[data-line]::before,
  [data-theme="light"] pre code.line-numbers .line:not([data-line])::before,
  [data-theme="light"] pre code[data-line-numbers] .line:not([data-line])::before,
  :root:not([data-theme="dark"]) pre code.line-numbers .line:not([data-line])::before,
  :root:not([data-theme="dark"]) pre code[data-line-numbers] .line:not([data-line])::before,
  [data-theme="light"] .not-prose pre code.line-numbers .line:not([data-line])::before,
  [data-theme="light"] .not-prose pre code[data-line-numbers] .line:not([data-line])::before,
  :root:not([data-theme="dark"]) .not-prose pre code.line-numbers .line:not([data-line])::before,
  :root:not([data-theme="dark"]) .not-prose pre code[data-line-numbers] .line:not([data-line])::before {
    opacity: 0.6 !important;
  }
  
  .not-prose pre code,
  .document-content .not-prose pre code {
    background: transparent !important;
    padding: 0 !important;
    border-radius: 0 !important;
    color: var(--color-fg-base) !important;
    font-family: 'SF Mono', SFMono-Regular, Menlo, Consolas, 'Liberation Mono', monospace !important;
    font-size: inherit !important;
    line-height: 1.7 !important;
    font-weight: 300 !important;
    display: block !important;
    width: 100% !important;
    margin: 0 !important;
  }

  /* Override line-height for .line elements inside code blocks */
  .not-prose pre code.line-numbers .line,
  .not-prose pre code[data-line-numbers] .line,
  .document-content .not-prose pre code.line-numbers .line,
  .document-content .not-prose pre code[data-line-numbers] .line,
  pre[class*="shiki"] code.line-numbers .line,
  pre[class*="shiki"] code[data-line-numbers] .line,
  .not-prose pre[class*="shiki"] code.line-numbers .line,
  .not-prose pre[class*="shiki"] code[data-line-numbers] .line {
    line-height: 1.5 !important;
    min-height: 1.5em !important;
  }
  
  /* Force font-weight on all elements inside code blocks - maximum specificity */
  .not-prose pre *,
  .document-content .not-prose pre *,
  .not-prose pre code *,
  .document-content .not-prose pre code *,
  .not-prose pre code span,
  .document-content .not-prose pre code span,
  .not-prose pre code span *,
  .document-content .not-prose pre code span *,
  pre[class*="shiki"] code *,
  pre[class*="shiki"] code span,
  pre[class*="shiki"] code span *,
  .not-prose pre[class*="shiki"] code *,
  .not-prose pre[class*="shiki"] code span,
  .not-prose pre[class*="shiki"] code span *,
  /* Even more specific selectors to override Shiki's inline styles */
  .not-prose pre[style] code[style] span[style],
  .not-prose pre[style] code[style] span[style] *,
  .document-content .not-prose pre[style] code[style] span[style],
  .document-content .not-prose pre[style] code[style] span[style] *,
  pre[class*="shiki"][style] code[style] span[style],
  pre[class*="shiki"][style] code[style] span[style] *,
  .not-prose pre[class*="shiki"][style] code[style] span[style],
  .not-prose pre[class*="shiki"][style] code[style] span[style] * {
    font-weight: 300 !important;
    font-weight: 300 !important; /* Duplicate for extra emphasis */
  }
  
  /* Direct selectors for Shiki pre elements - apply DS tokens */
  pre[class*="shiki"],
  pre.shiki,
  pre.shiki-themes,
  .not-prose pre[class*="shiki"],
  .not-prose pre.shiki,
  .not-prose pre.shiki-themes,
  article .not-prose pre[class*="shiki"],
  article .not-prose pre.shiki,
  article .not-prose pre.shiki-themes,
  .document-content .not-prose pre[class*="shiki"],
  .document-content .not-prose pre.shiki,
  .document-content .not-prose pre.shiki-themes,
  /* Override Shiki inline styles with maximum specificity */
  .document-content .not-prose > div > pre[class*="shiki"][style],
  .document-content .not-prose > div > pre.shiki[style],
  .document-content .not-prose > div > pre.shiki-themes[style],
  .document-content .not-prose > div > pre[data-theme][style],
  /* Maximum specificity for document-content Shiki pre - override all inline styles */
  .document-content .not-prose > div > pre[data-theme][style*="background"],
  .document-content .not-prose > div > pre[data-theme][style*="border"],
  .document-content .not-prose > div > pre[data-theme][style*="padding"] {
    margin: 0 !important;
    background-color: var(--color-surface-1) !important;
    border: 1px solid var(--color-border-base) !important;
    border-radius: var(--radius-sm) !important; /* 8px - zgodne z tokenami DS */
    padding: var(--space-4) var(--space-6) !important; /* 16px 24px - zgodne z tokenami DS */
  }

  /* Remove all borders and border-radius for code blocks in overflow-hidden containers */
  .overflow-hidden pre[class*="shiki"],
  .overflow-hidden .not-prose pre[class*="shiki"],
  .overflow-hidden article .not-prose pre[class*="shiki"],
  .overflow-hidden .document-content .not-prose pre[class*="shiki"],
  div.overflow-hidden > div > pre[class*="shiki"],
  div.overflow-hidden > div.not-prose > pre[class*="shiki"],
  .overflow-hidden > div > div > pre[class*="shiki"],
  .overflow-hidden > div.not-prose > pre[class*="shiki"] {
    border: none !important;
    border-radius: 0 !important;
  }

  /* CodeBlock wrapper div - remove margins by default */
  .relative.not-prose,
  .not-prose.relative {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }
  
  /* Add spacing after h2 when followed by CodeBlock */
  .document-content h2 + .relative.not-prose,
  .document-content h2 + .not-prose.relative,
  .document-content h2 + div.relative.not-prose {
    margin-top: 1rem !important;
  }

  /* Light mode CodeBlock */
  [data-theme="light"] .not-prose pre,
  :root:not([data-theme="dark"]) .not-prose pre {
    background-color: var(--color-surface-1) !important;
    border-color: var(--color-border-base) !important;
  }
  
  [data-theme="light"] .not-prose pre code,
  :root:not([data-theme="dark"]) .not-prose pre code {
    color: var(--foreground-primary) !important;
  }
  
  /* Dark mode CodeBlock */
  [data-theme="dark"] .not-prose pre {
    background-color: var(--color-surface-1) !important;
    border-color: var(--color-border-base) !important;
  }
  
  [data-theme="dark"] .not-prose pre code {
    color: var(--color-fg-base) !important;
  }
  
  /* DocumentContent - Typography styles for documentation content */
  /* Replaces .prose class - uses DS tokens */
  .document-content {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    color: var(--color-fg-base);
    width: 100%;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Constrain Article width while allowing responsive shrink */
  article.document-content {
    width: min(100%, 800px);
    max-width: 800px;
  }
  
  /* Headings in DocumentContent - using DS typography values from tailwind.config.ts */
  .document-content h1 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-display-md-size, 36px);
    font-weight: var(--typography-weight-medium, 500);
    line-height: var(--typography-display-md-line-height, var(--typography-line-height-display, 1.1));
    letter-spacing: var(--typography-display-md-letter-spacing, -0.72px);
    margin-top: 0;
    margin-bottom: 1rem;
    color: color-mix(in oklab, var(--color-fg-base) 90%, transparent);
  }
  
  .document-content h2 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-lg, 18px);
    font-weight: var(--typography-weight-semibold, 600);
    line-height: var(--typography-line-height-display, 1.1);
    margin-top: calc(var(--space-8, 32px) + var(--space-4, 16px)); /* 48px */
    margin-bottom: 1rem; /* 16px */
    color: color-mix(in oklab, var(--color-fg-base) 90%, transparent) !important;
  }
  
  /* Override margin-top and margin-bottom for h2 elements with m-0 class */
  .document-content h2.m-0 {
    margin-top: 0 !important;
    margin-bottom: 0 !important;
  }
  
  /* Typography styles for documentation content only - exclude components */
  /* Only apply to h3 that are direct children or in text content, not in component previews */
  .document-content > h3,
  .document-content h2 + h3,
  .document-content p + h3 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-lg, 18px);
    font-weight: var(--typography-weight-medium, 500);
    line-height: var(--typography-line-height-display, 1.1);
    margin-top: 2rem;
    margin-bottom: 1rem;
    color: var(--color-fg-base);
  }
  
  /* Exclude accordion headers from document-content h3 styles - they have their own spacing */
  .document-content [data-orientation="vertical"] h3[class*="flex"] {
    margin-top: 1rem !important; /* mt-4 = 16px */
    margin-bottom: 1rem !important; /* mb-4 = 16px */
  }
  
  /* Components in .preview use their own DS tokens - no overrides needed */
  /* Components outside .preview also use their own DS tokens */
  
  .document-content h4 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-2xl, 22px);
    font-weight: var(--typography-weight-semibold, 600);
    line-height: var(--typography-line-height-text, 1.5);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    color: var(--color-fg-base);
  }
  
  .document-content h5 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-xl, 20px);
    font-weight: var(--typography-weight-semibold, 600);
    line-height: var(--typography-line-height-text, 1.5);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    color: var(--color-fg-base);
  }
  
  .document-content h6 {
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-lg, 18px);
    font-weight: var(--typography-weight-semibold, 600);
    line-height: var(--typography-line-height-text, 1.5);
    margin-top: 1.5rem;
    margin-bottom: 0.75rem;
    color: var(--color-fg-base);
  }
  
  /* Paragraphs in DocumentContent */
  .document-content p {
    /* Light mode: slightly higher alpha for readability */
    color: color-mix(in oklab, var(--color-fg-base) 80%, transparent);
    font-family: var(--typography-font-sans, Geist, ui-sans-serif, system-ui, sans-serif);
    font-size: var(--typography-size-md, 16px);
    font-style: normal;
    font-weight: var(--typography-weight-regular, 400);
    line-height: var(--typography-line-height-body, 1.6);
    margin-top: 0;
    margin-bottom: var(--space-6, 24px);
  }

  /* Dark mode: keep paragraphs a bit softer */
  [data-theme="dark"] .document-content p {
    color: color-mix(in oklab, var(--color-fg-base) 70%, transparent);
  }

  /* Emphasis in DocumentContent */
  .document-content strong {
    font-weight: var(--typography-weight-semibold, 600);
  }
  
  /* ActivityFeed inside docs: avoid .document-content p typography overrides (size, color, spacing) */
  .document-content .fragment-activity-feed p.text-sm[class*="text-[color:var(--color-fg-muted)]"] {
    color: var(--color-fg-muted) !important;
    margin-bottom: var(--space-1) !important;
  }
  .document-content .fragment-activity-feed p.text-xs[class*="text-[color:var(--color-fg-muted)]"],
  .document-content .fragment-activity-feed p[class*="text-[10px]"][class*="text-[color:var(--color-fg-muted)]"] {
    font-size: 0.75rem !important; /* text-xs = 12px */
    font-weight: 400 !important;
    color: var(--color-fg-muted) !important;
    margin-bottom: 0 !important;
  }
  
  /* Exclude components in .preview from document-content typography inheritance */
  /* Components use their own DS tokens - prevent all inheritance */
  .document-content .preview,
  .document-content .preview * {
    font-family: ui-sans-serif, system-ui, sans-serif !important;
  }
  
  /* Ensure Tailwind text size classes work in preview */
  .document-content .preview .text-xs {
    font-size: 0.75rem !important; /* 12px */
  }
  
  .document-content .preview .text-sm {
    font-size: 0.875rem !important; /* 14px */
  }
  
  .document-content .preview .text-md {
    font-size: 1rem !important; /* 16px */
  }
  
  .document-content .preview .text-lg {
    font-size: 1.125rem !important; /* 18px */
  }
  
  .document-content .preview .text-2xl {
    font-size: 1.375rem !important; /* 22px */
  }
  
  /* Ensure Tailwind font weight classes work in preview */
  .document-content .preview .font-normal {
    font-weight: 400 !important;
  }
  
  .document-content .preview .font-medium {
    font-weight: 500 !important;
  }
  
  .document-content .preview .font-semibold {
    font-weight: 600 !important;
  }
  
  /* Intro paragraph - smaller and darker - must come after .document-content p */
  .document-content p.intro-text {
    color: var(--color-fg-muted) !important;
    font-size: var(--typography-size-md) !important; /* 16px - zgodne z tokenami DS */
    font-weight: 500 !important;
    line-height: 160% !important;
    font-family: Geist, sans-serif !important;
    margin-bottom: 0.5rem !important; /* Reduced spacing below to make room for badges */
  }
  
  /* Position badges after intro-text */
  .document-content p.intro-text + .document-content-badges-container {
    margin-top: 1.5rem !important;
    margin-bottom: 2rem !important;
  }
  
  /* Dark mode: intro text uses the same semantic token */
  [data-theme="dark"] .document-content p.intro-text {
    color: var(--color-fg-muted) !important;
  }
  
  /* Lists in DocumentContent */
  .document-content ul {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding-left: 1.5rem;
    list-style-type: disc; /* Bullets dla unordered lists */
  }
  
  .document-content ol {
    margin-top: 1rem;
    margin-bottom: 1rem;
    padding-left: 1.5rem;
    list-style-type: decimal; /* Numery dla ordered lists */
  }
  
  .document-content li {
    margin-top: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: var(--typography-size-md, 16px);
    font-weight: var(--typography-weight-regular, 400);
    /* Light mode: match paragraph readability */
    color: color-mix(in oklab, var(--color-fg-base) 80%, transparent);
    display: list-item; /* Zapewnia wyświetlanie markerów listy */
  }

  /* Force list item text + markers to match paragraph alpha tint */
  .document-content ul > li,
  .document-content ol > li {
    color: color-mix(in oklab, var(--color-fg-base) 80%, transparent) !important;
  }

  .document-content ul > li::marker,
  .document-content ol > li::marker {
    color: color-mix(in oklab, var(--color-fg-base) 80%, transparent) !important;
  }

  /* Dark mode: keep lists a bit softer */
  [data-theme="dark"] .document-content li {
    color: color-mix(in oklab, var(--color-fg-base) 70%, transparent);
  }

  [data-theme="dark"] .document-content ul > li,
  [data-theme="dark"] .document-content ol > li {
    color: color-mix(in oklab, var(--color-fg-base) 70%, transparent) !important;
  }

  [data-theme="dark"] .document-content ul > li::marker,
  [data-theme="dark"] .document-content ol > li::marker {
    color: color-mix(in oklab, var(--color-fg-base) 70%, transparent) !important;
  }
  
  .document-content li p {
    color: color-mix(in oklab, var(--color-fg-base) 80%, transparent);
    margin-bottom: 0;
  }

  [data-theme="dark"] .document-content li p {
    color: color-mix(in oklab, var(--color-fg-base) 70%, transparent);
  }

  /* Strong inside paragraphs: slightly higher alpha for emphasis */
  .document-content p strong {
    color: color-mix(in oklab, var(--color-fg-base) 90%, transparent) !important;
    font-weight: var(--typography-weight-medium, 500);
  }

  /* Strong inside list items: slightly higher alpha for emphasis */
  .document-content li strong {
    /* Light mode: slightly softer emphasis */
    color: color-mix(in oklab, var(--color-fg-base) 90%, transparent) !important;
    font-weight: var(--typography-weight-medium, 500);
  }

  /* Dark mode: keep emphasis but not as strong as headings */
  [data-theme="dark"] .document-content li strong {
    color: color-mix(in oklab, var(--color-fg-base) 90%, transparent) !important;
    font-weight: var(--typography-weight-medium, 500);
  }
  
  /* Links in DocumentContent */
  .document-content a {
    color: var(--color-fg-base);
    text-decoration: underline;
    text-underline-offset: var(--space-1);
  }
  
  /* Remove underline from badge links */
  .document-content .document-content-badges a,
  .document-content .document-content-badges-container a {
    text-decoration: none !important;
  }
  
  .document-content a:hover {
    opacity: 0.8;
  }
  
  .document-content .document-content-badges a:hover,
  .document-content .document-content-badges-container a:hover {
    opacity: 1;
  }
  
  /* Code in DocumentContent */
  .document-content code {
    font-family: var(--typography-font-mono, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace);
    font-size: var(--typography-size-sm, 14px);
    line-height: var(--typography-line-height-text, 1.5);
    font-weight: var(--typography-weight-regular, 400);
  }
  
  /* Inline code (not in pre blocks) */
  .document-content :not(pre) > code {
    background-color: var(--color-surface-1); /* Używa tokena DS dla tła */
    padding: var(--space-1) var(--space-3); /* 4px 12px - zgodne z tokenami DS */
    margin: 0;
    border-radius: var(--radius-md); /* 12px - zgodne z tokenami DS */
    font-size: 0.8125em;
    color: var(--color-fg-base);
    font-weight: 400;
    line-height: 1;
    display: inline-block;
    vertical-align: baseline;
  }

  /* Hide legacy "Edit this page on GitHub" footer if present */
  .document-content div.mt-16.border-t[style*="padding-top"][style*="3rem"] {
    display: none !important;
  }
  
  /* Spacing adjustments */
  .document-content h1 + p {
    margin-top: 0 !important;
  }
  
  .document-content h2 + p,
  .document-content h3 + p,
  .document-content h4 + p {
    margin-top: 0;
  }
  
  /* rehype-pretty-code styles - matching shadcn/ui appearance */
  /* Block code: rehype-pretty-code wraps fenced code blocks in a figure */
  .document-content figure[data-rehype-pretty-code-figure] {
    margin: 1rem 0;
    position: relative;
  }
  
  .document-content figure[data-rehype-pretty-code-figure] pre {
    overflow-x: auto;
    padding: 1rem 1.25rem;
    background-color: var(--color-surface-1);
    border: 1px solid var(--color-border-base);
    border-radius: 0.5rem;
    margin: 0;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
    font-size: 0.875rem;
    line-height: 1.7;
    font-weight: 300 !important;
  }

  /* Inline code: rehype-pretty-code may wrap backticks in a span.
     Keep the wrapper neutral so the existing inline <code> styling applies. */
  .document-content span[data-rehype-pretty-code-figure] {
    display: inline;
  }
  
  /* Fallback for pre without figure wrapper */
  .document-content pre {
    overflow-x: auto;
    padding: var(--space-4) var(--space-6); /* 16px 24px - zgodne z tokenami DS */
    background-color: var(--color-surface-1);
    border: 1px solid var(--color-border-base);
    border-radius: var(--radius-sm); /* 8px - zgodne z tokenami DS */
    margin: 1rem 0;
    font-family: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, 'Liberation Mono', monospace;
    font-size: 0.875rem;
    line-height: 1.7;
    font-weight: 300 !important;
  }
  
  /* rehype-pretty-code code element */
  .document-content figure[data-rehype-pretty-code-figure] pre code {
    display: grid;
    min-width: 100%;
    background: transparent;
    padding: 0;
    white-space: pre;
    font-weight: 300 !important;
  }
  
  /* Shiki colors for rehype-pretty-code */
  .document-content figure[data-rehype-pretty-code-figure] code span[style*="--shiki"],
  .document-content pre code span[style*="--shiki"] {
    color: var(--shiki-dark, var(--color-fg-base));
    font-style: var(--shiki-dark-font-style, normal);
  }
  
  /* Light mode rehype-pretty-code */
  [data-theme="light"] .document-content figure[data-rehype-pretty-code-figure] pre,
  :root:not([data-theme="dark"]) .document-content figure[data-rehype-pretty-code-figure] pre,
  [data-theme="light"] .document-content pre,
  :root:not([data-theme="dark"]) .document-content pre {
    background-color: var(--color-surface-1);
    border-color: var(--color-border-base);
  }
  
  [data-theme="light"] .document-content figure[data-rehype-pretty-code-figure] code span[style*="--shiki"],
  :root:not([data-theme="dark"]) .document-content figure[data-rehype-pretty-code-figure] code span[style*="--shiki"],
  [data-theme="light"] .document-content pre code span[style*="--shiki"],
  :root:not([data-theme="dark"]) .document-content pre code span[style*="--shiki"] {
    color: var(--shiki-light, var(--foreground-primary));
    font-style: var(--shiki-light-font-style, normal);
  }
  
  /* Dark mode rehype-pretty-code */
  [data-theme="dark"] .document-content figure[data-rehype-pretty-code-figure] pre,
  [data-theme="dark"] .document-content pre {
    background-color: var(--color-surface-1);
    border-color: var(--color-border-base);
  }
  
  [data-theme="dark"] .document-content figure[data-rehype-pretty-code-figure] code span[style*="--shiki"],
  [data-theme="dark"] .document-content pre code span[style*="--shiki"] {
    color: var(--shiki-dark, var(--color-fg-base));
    font-style: var(--shiki-dark-font-style, normal);
  }
  
  /* Code lines with data-line attribute - minimal default styles */
  .document-content figure[data-rehype-pretty-code-figure] [data-line] {
    padding: 0 1rem;
  }
  
  .document-content figure[data-rehype-pretty-code-figure] [data-line]:empty {
    display: none;
  }
  
  .document-content figure[data-rehype-pretty-code-figure] code [data-line] > span {
    display: inline;
  }
  
  /* Line numbers */
  .document-content figure[data-rehype-pretty-code-figure] code[data-line-numbers] {
    counter-reset: line;
  }
  
  .document-content figure[data-rehype-pretty-code-figure] code[data-line-numbers] > [data-line]::before {
    counter-increment: line;
    content: counter(line);
    margin-right: 1rem;
    display: inline-block;
    width: 1rem;
    text-align: right;
    color: var(--color-fg-muted);
  }
  
  /* Highlighted lines */
  .document-content figure[data-rehype-pretty-code-figure] [data-line][data-highlighted] {
    background-color: rgba(255, 255, 255, 0.05);
    border-left: 1px solid color-mix(in oklab, var(--foreground-primary) 2%, transparent);
    padding-left: calc(1rem - 1px);
    margin-left: -1rem;
    margin-right: -1rem;
    padding-right: 1rem;
  }
  
  [data-theme="light"] .document-content figure[data-rehype-pretty-code-figure] [data-line][data-highlighted],
  :root:not([data-theme="dark"]) .document-content figure[data-rehype-pretty-code-figure] [data-line][data-highlighted] {
    background-color: rgba(0, 0, 0, 0.05);
    border-left: 1px solid color-mix(in oklab, var(--foreground-primary) 2%, transparent);
  }
  
  /* Highlighted characters/words */
  .document-content figure[data-rehype-pretty-code-figure] [data-highlighted-chars] {
    border-radius: 0.25rem;
    background-color: color-mix(in oklab, var(--color-brand-primary) 20%, transparent);
    box-shadow: 0 0 0 var(--space-1) color-mix(in oklab, var(--color-brand-primary) 20%, transparent);
  }
  
  [data-theme="light"] .document-content figure[data-rehype-pretty-code-figure] [data-highlighted-chars],
  :root:not([data-theme="dark"]) .document-content figure[data-rehype-pretty-code-figure] [data-highlighted-chars] {
    background-color: color-mix(in oklab, var(--color-brand-primary) 15%, transparent);
    box-shadow: 0 0 0 var(--space-1) color-mix(in oklab, var(--color-brand-primary) 15%, transparent);
  }
  
  .document-content figure[data-rehype-pretty-code-figure] [data-chars-id] {
    border-bottom: 1px solid color-mix(in oklab, var(--foreground-primary) 2%, transparent);
    padding: 0.25rem 0;
    box-shadow: none;
  }
  
  /* Fallback styles for old structure (without figure wrapper) */
  .document-content pre code span[data-line] {
    padding: 0 1rem;
  }
  
  .document-content pre code span[data-line]:empty {
    display: none;
  }
  
  .document-content pre code span[data-line] > span {
    display: inline;
  }
  
  .document-content pre code {
    white-space: pre;
    font-weight: 300 !important;
  }
  
  .document-content pre code span[data-line][data-highlighted] {
    background-color: rgba(255, 255, 255, 0.05);
    border-left: 1px solid color-mix(in oklab, var(--foreground-primary) 2%, transparent);
    padding-left: calc(1rem - 1px);
    margin-left: -1rem;
    margin-right: -1rem;
    padding-right: 1rem;
  }
  
  [data-theme="light"] .document-content pre code span[data-line][data-highlighted],
  :root:not([data-theme="dark"]) .document-content pre code span[data-line][data-highlighted] {
    background-color: rgba(0, 0, 0, 0.05);
    border-left: 1px solid color-mix(in oklab, var(--foreground-primary) 2%, transparent);
  }
  
  /* CommandItem hover effect - ensure it works even with data-selected */
  /* Use high specificity selectors to override any inline styles or data attributes */
  div[cmdk-item]:hover,
  div[cmdk-item][data-selected="true"]:hover,
  div[cmdk-item][data-selected="false"]:hover,
  div[cmdk-item][aria-selected="true"]:hover,
  div[cmdk-item][aria-selected="false"]:hover,
  [cmdk-item]:hover,
  [cmdk-item][data-selected="true"]:hover,
  [cmdk-item][data-selected="false"]:hover,
  [cmdk-item][aria-selected="true"]:hover,
  [cmdk-item][aria-selected="false"]:hover,
  [role="option"][cmdk-item]:hover,
  [role="option"][cmdk-item][data-selected="true"]:hover,
  [role="option"][cmdk-item][data-selected="false"]:hover {
    background-color: var(--color-surface-2) !important;
    background: var(--color-surface-2) !important;
    color: var(--color-fg-base) !important;
  }
  
  /* CardContent span color override - ensure spans use foreground base color */
  /* Target only spans directly inside value/content divs, exclude badges and explicitly styled elements */
  div.mt-2.mb-1 > div.text-2xl span,
  div[class*="mt-2"][class*="mb-1"] > div[class*="text-2xl"] span {
    color: var(--color-fg-base) !important;
  }
  
  /* Ensure description text (p elements) inside CardContent use muted color */
  div.mt-2.mb-1 > p.text-xs,
  div[class*="mt-2"][class*="mb-1"] > p[class*="text-xs"] {
    color: var(--color-fg-muted) !important;
  }
}

